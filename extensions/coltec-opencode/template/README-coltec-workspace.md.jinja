# Coltec Workspace: {{ env }}

This workspace wraps the asset repo at `codebase/` and layers on Coltec tooling for **{{ org }}/{{ project }}** ({{ project_type }}).

## Directory Structure

```
{{ env }}/
├── .devcontainer/
│   ├── devcontainer.json      # Devcontainer configuration
│   ├── workspace-spec.yaml    # Coltec workspace specification
│   └── scripts/               # Lifecycle hooks
├── .opencode/                 # Supervisor agent configuration
├── codebase/                  # Your project source code (git submodule or clone)
├── agent-context/             # Bidirectional sync with R2 (shared context)
└── scratch/                   # Push-only sync for temporary outputs
```

## Supervisor Agent (OpenCode)

- Base config lives in `.opencode/opencode.json`.
- Run `opencode` to attach to the long-running tmux session.
- Use `OPENCODE_TMUX_DISABLE=true opencode start` to bypass tmux.
- Nexus overlays are written to `.sessions/<id>/.opencode/config.json`.

## Sync Paths

| Path | Direction | Interval | Purpose |
|------|-----------|----------|---------|
| `/workspace/agent-context` | Bidirectional | 60s | Shared context across sessions |
| `/workspace/scratch` | Push-only | 300s | Logs, outputs, temporary files |

## Required Environment Variables

Set these in your host environment before starting the devcontainer:

| Variable | Description |
|----------|-------------|
| `RCLONE_S3_ACCESS_KEY_ID` | Cloudflare R2 access key |
| `RCLONE_S3_SECRET_ACCESS_KEY` | Cloudflare R2 secret key |
| `RCLONE_S3_ENDPOINT` | R2 endpoint URL |
| `TAILSCALE_AUTH_KEY` | (Optional) Tailscale auth key for networking |

## Getting Started

1. Clone your project into `codebase/`:
   ```bash
   git clone <your-repo> codebase
   ```

2. Start the devcontainer:
   ```bash
   devcontainer up --workspace-folder .
   ```

3. The daemon will automatically:
   - Validate the workspace spec
   - Connect to Tailscale (if auth key provided)
   - Start bidirectional sync for `agent-context/`
   - Start push-only sync for `scratch/`

## Updating

To update this workspace with template changes:

```bash
copier update --trust
```

---

*Generated by [coltec-codespaces](https://github.com/PSU3D0/coltec-codespaces)*
